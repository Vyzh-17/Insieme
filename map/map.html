<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Accessible Map for Disabled Persons</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root {
    --primary: #0066CC;  /* High-contrast blue */
    --secondary: #CC3300; /* High-contrast red */
    --light: #FFCC00;
    --dark: #333333;
    --white: #FFFFFF;
    --shadow-sm: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
    --shadow-md: 0 4px 6px rgba(0,0,0,0.1), 0 1px 3px rgba(0,0,0,0.08);
    --shadow-lg: 0 10px 20px rgba(0,0,0,0.1), 0 6px 6px rgba(0,0,0,0.1);
  }
  
  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 20px;
    color: #333;
    line-height: 1.6;
    background-color: #f5f5f5;
  }
  
  .container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 10px;
    padding: 25px;
    box-shadow: var(--shadow-sm);
  }
  
  h1 {
    color: var(--dark);
    text-align: center;
    margin-bottom: 25px;
    font-weight: 600;
  }
  
  /* Custom icon styles with high visibility */
  .custom-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 18px;
    border: 3px solid white;
    box-shadow: 0 0 0 3px rgba(0,0,0,0.5);
    text-shadow: 0 1px 2px rgba(0,0,0,0.5);
  }
  
  .wheelchair-icon {
    background-color: var(--primary);
  }
  
  .braille-icon {
    background-color: var(--secondary);
  }

  /* Pulsing animation for active markers */
  @keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  
  .custom-icon.highlight {
    animation: pulse 1.5s infinite;
  }

  /* Ensure map markers are visible */
  .leaflet-marker-icon {
    filter: drop-shadow(0 0 4px rgba(0,0,0,0.7));
  }

  .filter-container {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
    justify-content: center;
  }
  
  .filter-btn {
    padding: 12px 20px;
    font-size: 16px;
    cursor: pointer;
    border: none;
    border-radius: 30px;
    background-color: var(--primary);
    color: white;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 8px;
  }
  
  .filter-btn.active {
    background-color: var(--secondary);
  }
  
  #map { 
    height: 500px; 
    width: 100%; 
    margin-bottom: 20px;
    border-radius: 8px;
    box-shadow: var(--shadow-sm);
  }
  
  #addPlaceForm {
    background-color: #f9f9f9;
    padding: 20px;
    border-radius: 8px;
    margin-top: 20px;
    box-shadow: var(--shadow-sm);
  }
  
  .form-group {
    margin-bottom: 15px;
  }
  
  label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
    color: var(--dark);
  }
  
  input, select {
    width: 100%;
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 16px;
  }
  
  button[type="submit"] {
    background-color: var(--primary);
    color: white;
    border: none;
    padding: 12px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    transition: all 0.3s ease;
  }
  
  /* Screen reader only text */
  .sr-only {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    overflow: hidden;
    clip: rect(0,0,0,0);
    white-space: nowrap;
    border: 0;
  }
</style>
</head>
<body>

<div class="container">
  <h1><i class="fas fa-wheelchair" aria-hidden="true"></i> Accessible Map for Disabled Persons</h1>
  
  <div class="filter-container">
    <button class="filter-btn active" aria-label="Show all accessible places" onclick="showAll()" id="allBtn">
      <i class="fas fa-globe" aria-hidden="true"></i> All
    </button>
    <button class="filter-btn" aria-label="Show wheelchair accessible places" onclick="filterType('Wheelchair')" id="wheelchairBtn">
      <i class="fas fa-wheelchair" aria-hidden="true"></i> Wheelchair
    </button>
    <button class="filter-btn" aria-label="Show braille accessible places" onclick="filterType('Braille')" id="brailleBtn">
      <i class="fas fa-braille" aria-hidden="true"></i> Braille
    </button>
  </div>

  <div id="map" 
       role="region" 
       aria-label="Interactive map showing accessible locations"
       tabindex="0">
  </div>

  <!-- Hidden text info for screen readers / Braille -->
  <div id="markerInfoContainer" class="sr-only" aria-live="polite"></div>

  <!-- Form to add new places -->
  <h2>Add a new accessible location</h2>
  <form id="addPlaceForm">
    <div class="form-group">
      <label for="placeName">Location Name:</label>
      <input type="text" id="placeName" required aria-required="true">
    </div>
    <div class="form-group">
      <label for="placeType">Accessibility Type:</label>
      <select id="placeType" aria-label="Select accessibility type">
        <option value="Wheelchair">Wheelchair Accessible</option>
        <option value="Braille">Braille Accessible</option>
      </select>
    </div>
    <div class="form-group">
      <label for="placeDesc">Description:</label>
      <input type="text" id="placeDesc" required aria-required="true" aria-label="Description of accessibility features">
    </div>
    <button type="submit">
      <i class="fas fa-plus" aria-hidden="true"></i> Add Location
    </button>
  </form>
  <p>Or <strong>click on the map</strong> to add a marker at that location.</p>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
// Initialize map
var map = L.map('map').setView([28.6139, 77.2090], 14);

// Add OpenStreetMap tiles
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Â© OpenStreetMap contributors',
  maxZoom: 19
}).addTo(map);

// Custom icon creation with high visibility
function createCustomIcon(type) {
  return L.divIcon({
    html: `<div class="custom-icon ${type.toLowerCase()}-icon" 
           role="img" aria-label="${type} accessible location">
             <i class="fas ${type === 'Wheelchair' ? 'fa-wheelchair' : 'fa-braille'}"></i>
           </div>`,
    className: '',
    iconSize: [40, 40],
    iconAnchor: [20, 20],
    popupAnchor: [0, -20]
  });
}

// Store all markers
var markers = [];
var currentMarkers = []; // Currently displayed markers

// Function to add a new marker
function addMarker(place) {
  var marker = L.marker(place.coords, {
    icon: createCustomIcon(place.type),
    title: place.name,
    alt: place.name + ' - ' + place.type + ' accessible',
    keyboard: true,
    riseOnHover: true
  }).addTo(map);
  
  // Create popup content
  var popupContent = `
    <h3>${place.name}</h3>
    <p><strong>Type:</strong> ${place.type}</p>
    <p>${place.description}</p>
  `;
  
  marker.bindPopup(popupContent);
  
  // Add click event for accessibility
  marker.on('click', function() {
    // For screen readers
    document.getElementById("markerInfoContainer").textContent = 
      `${place.name}. ${place.type} accessible. ${place.description}`;
    
    // For speech synthesis
    if ('speechSynthesis' in window) {
      var utterance = new SpeechSynthesisUtterance(
        `${place.name}. ${place.description}`
      );
      speechSynthesis.speak(utterance);
    }
  });
  
  // Add to our markers array
  markers.push({
    marker: marker,
    type: place.type,
    data: place
  });
  
  // Also add to current markers
  currentMarkers.push(marker);
  
  return marker;
}

// Sample initial data
var places = [
  {
    name: "City Hall Restroom", 
    type: "Wheelchair", 
    coords: [28.614, 77.210], 
    description: "Fully accessible restroom with automatic doors"
  },
  {
    name: "Main Library Entrance", 
    type: "Braille", 
    coords: [28.613, 77.207], 
    description: "Braille signage and tactile paths at main entrance"
  }
];

// Add initial markers
places.forEach(function(place) {
  addMarker(place);
});

// Filter functions
function filterType(type) {
  // Update button states
  document.getElementById('allBtn').classList.remove('active');
  document.getElementById('wheelchairBtn').classList.remove('active');
  document.getElementById('brailleBtn').classList.remove('active');
  document.getElementById(type.toLowerCase() + 'Btn').classList.add('active');
  
  // Clear current markers
  currentMarkers.forEach(marker => map.removeLayer(marker));
  currentMarkers = [];
  
  // Add filtered markers
  markers.forEach(item => {
    if (item.type === type) {
      item.marker.addTo(map);
      currentMarkers.push(item.marker);
      // Add highlight effect
      item.marker._icon.classList.add('highlight');
    } else {
      // Remove highlight effect
      if (item.marker._icon) item.marker._icon.classList.remove('highlight');
    }
  });
}

function showAll() {
  // Update button states
  document.getElementById('allBtn').classList.add('active');
  document.getElementById('wheelchairBtn').classList.remove('active');
  document.getElementById('brailleBtn').classList.remove('active');
  
  // Clear current markers
  currentMarkers.forEach(marker => map.removeLayer(marker));
  currentMarkers = [];
  
  // Add all markers
  markers.forEach(item => {
    item.marker.addTo(map);
    currentMarkers.push(item.marker);
    // Remove highlight effect
    if (item.marker._icon) item.marker._icon.classList.remove('highlight');
  });
}

// Add marker via form
document.getElementById('addPlaceForm').addEventListener('submit', function(e){
  e.preventDefault();

  var name = document.getElementById('placeName').value;
  var type = document.getElementById('placeType').value;
  var desc = document.getElementById('placeDesc').value;

  // Default coords: map center
  var coords = map.getCenter();
  
  var newPlace = {
    name: name,
    type: type,
    coords: [coords.lat, coords.lng],
    description: desc
  };
  
  // Add the new marker
  addMarker(newPlace);
  
  // Announce addition
  if ('speechSynthesis' in window) {
    var utterance = new SpeechSynthesisUtterance(
      `Added new ${type} accessible location: ${name}`
    );
    speechSynthesis.speak(utterance);
  }
  
  // Reset form
  this.reset();
  document.getElementById('placeName').focus();
});

// Add marker by clicking on map
map.on('click', function(e){
  var name = prompt("Enter location name:");
  if (!name) return;
  
  var type = prompt("Enter accessibility type (Wheelchair/Braille):", "Wheelchair");
  if (!type) type = "Wheelchair";
  
  var desc = prompt("Enter description of accessibility features:");
  if (!desc) desc = "No description provided";
  
  var newPlace = {
    name: name,
    type: type,
    coords: [e.latlng.lat, e.latlng.lng],
    description: desc
  };
  
  // Add the new marker
  addMarker(newPlace);
  
  // Announce addition
  if ('speechSynthesis' in window) {
    var utterance = new SpeechSynthesisUtterance(
      `Added new ${type} accessible location at clicked position: ${name}`
    );
    speechSynthesis.speak(utterance);
  }
});

// Make map focusable for keyboard users
document.getElementById('map').tabIndex = 0;
</script>
</body>
</html>